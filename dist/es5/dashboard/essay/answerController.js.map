{"version":3,"sources":["../../../../js/dashboard/essay/answerController.js"],"names":["app","controller","$scope","fetcher","$timeout","dialog","globalVar","limit","iterate","typeDelay","category","data","pauseAjx","doneAjx","search","nodata","loading","startDate","moment","year","startOf","toDate","endDate","dateChange","init","downloadLink","getFilesLink","_","omitBy","startdate","format","dateFormat","enddate","like","getSearch","id","isNil","length","openHint","notif","essayAnsHint","stringDate","loadMoar","offset","getAllEssayAns","response","status_code","result","concat","delayTimeout","$watch","newVal","oldVal","cancel","initData","selectCate","selected","delete","name","e","stopPropagation","confirm","deleteEssayAns","getAllCategory","categories","chain","map","o","ID_category","category_name","sortBy","unshift","value","head"],"mappings":"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","file":"answerController.js","sourcesContent":["app.controller('EssayAnsController', ['$scope', 'fetcher', '$timeout', 'dialog', 'globalVar', function ($scope, fetcher, $timeout, dialog, globalVar) {\n    'use strict';\n\n\tlet limit\t\t= 15;\n\tlet iterate\t\t= 0;\n\tlet typeDelay\t= 500;\n\n\t// $scope.categories\t= [];\n\t$scope.category\t\t= {};\n\n\t$scope.data\t\t= [];\n\t$scope.pauseAjx\t= false;\n\t$scope.doneAjx\t= false;\n\n\t$scope.search\t= \"\";\n\t$scope.nodata\t= null;\n\t$scope.loading\t= globalVar.loading;\n\n\t$scope.startDate\t= moment().year(2017).startOf('year').toDate();\n\t$scope.endDate\t\t= moment().toDate();\n\t$scope.dateChange\t= () => { init(); }\n\t$scope.downloadLink\t= () => (fetcher.getFilesLink('essayansdata', _.omitBy({\n\t\tstartdate: moment($scope.startDate).format(globalVar.dateFormat),\n\t\tenddate: moment($scope.endDate).format(globalVar.dateFormat),\n\t\tlike: getSearch(),\n\t\tcategory: $scope.category.id\n\t}, _.isNil)));\n\n\tlet getSearch\t= () => ($scope.search ? (($scope.search.length >= 3) ? $scope.search : null) : null);\n\n\t$scope.openHint\t= () => { dialog.notif(globalVar.essayAnsHint); }\n\t$scope.toDate\t= (stringDate) => (moment(stringDate).format(\"dddd, Do MMMM YYYY, hh:mm\"));\n\n\t$scope.loadMoar\t= () => {\n\t\t$scope.pauseAjx\t= true;\n\t\titerate++;\n\t\tlet data = _.omitBy({\n\t\t\tlimit,\n\t\t\toffset: iterate * limit,\n\t\t\tlike: getSearch(),\n\t\t\tcategory: $scope.category.id,\n\t\t\tstartdate: moment($scope.startDate).format(globalVar.dateFormat),\n\t\t\tenddate: moment($scope.endDate).format(globalVar.dateFormat)\n\t\t}, _.isNil);\n\t\tfetcher.getAllEssayAns(data, (response) => {\n\t\t\tif (response.response == 'OK' && response.status_code == 200 && response.result) {\n\t\t\t\tif (response.result.length < limit) { $scope.doneAjx = true; }\n\t\t\t\t$scope.data \t= _.concat($scope.data, response.result);\n\t\t\t} else {\n\t\t\t\t$scope.doneAjx\t= true;\n\t\t\t}\n\t\t\t$scope.pauseAjx\t= false;\n\t\t});\n\t};\n\n\tlet delayTimeout;\n\t$scope.$watch('search', (newVal, oldVal) => {\n\t\tif (!_.isNil(newVal) && newVal !== oldVal) {\n\t\t\tif (delayTimeout) $timeout.cancel(delayTimeout);\n\n\t\t\tdelayTimeout\t= $timeout(() => {\n\t\t\t\tif (newVal.length >= 3) {\n\t\t\t\t\tinitData(newVal);\n\t\t\t\t} else if (newVal == '' && !$scope.pauseAjx) {\n\t\t\t\t\tinitData();\n\t\t\t\t}\n\t\t\t}, typeDelay);\n\t\t} else {\n\t\t\t$scope.search = '';\n\t\t}\n\t});\n\n\t$scope.selectCate\t= (selected) => { $scope.category = selected; initData(getSearch()); }\n\n\t$scope.delete\t= (id, name, e) => {\n\t\te.stopPropagation();\n\t\tdialog.confirm('Are you sure you wanna delete an answer by ' + name + '?', (response) => {\n\t\t\tif (response) {\n\t\t\t\tfetcher.deleteEssayAns(id, (response) => {\n\t\t\t\t\tif (response.response == 'OK' && response.status_code == 200) {\n\t\t\t\t\t\tinitData(getSearch());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tlet initData\t= (like) => {\n\t\t$scope.pauseAjx\t= true;\n\t\t$scope.nodata\t= null;\n\t\titerate\t= 0;\n\t\tfetcher.getAllEssayAns(_.omitBy({ limit, like, offset: 0, category: $scope.category.id, startdate: moment($scope.startDate).format(globalVar.dateFormat), enddate: moment($scope.endDate).format(globalVar.dateFormat) }, _.isNil), (response) => {\n\t\t\tif (response.response == 'OK' && response.status_code == 200) {\n\t\t\t\t$scope.data\t= response.result;\n\t\t\t\tif (!response.result) {\n\t\t\t\t\t$scope.nodata = globalVar.nodata; $scope.doneAjx = true;\n\t\t\t\t} else  if (response.result.length < limit) {\n\t\t\t\t\t$scope.doneAjx = true;\n\t\t\t\t} else {\n\t\t\t\t\t$scope.doneAjx\t= false;\n\t\t\t\t}\n\t\t\t\t$scope.pauseAjx\t= false;\n\t\t\t}\n\t\t});\n\t}\n\n\tlet init = () => {\n\t\tfetcher.getAllCategory({}, (response) => {\n\t\t\tif (response.response == 'OK' && response.status_code == 200) {\n\t\t\t\t$scope.categories\t= _.chain(response.result).map((o) => ({ id: o.ID_category, name: o.category_name })).sortBy(['name']).unshift({ id: null, name: 'Semua' }).value();\n\t\t\t\t$scope.category\t\t= _.head($scope.categories);\n\n\t\t\t\tinitData();\n\t\t\t}\n\t\t});\n\t}\n\n\tinit();\n}]);\n"]}