{"version":3,"sources":["../../js/directive.js"],"names":["app","directive","$timeout","restrict","link","scope","elem","attrs","autofocus","focus","$document","require","ngModel","bind","e","keyCode","which","tagName","angular","element","activeElement","_","includes","String","fromCharCode","openDropdown","isCalender","class","childNode","child","children","length","current","concat","chain","pick","times","values","value","theFunction","$apply","target","intersection","attr","split","widthTreshold","params","forceHeight","JSON","parse","wantedRatio","$","window","width","$watch","newVal","oldVal","css","height","setVillageWidth","minWidth","finalWidth","$parent","maxVillage","replace"],"mappings":"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","file":"directive.js","sourcesContent":["app.directive('autofocus', ['$timeout', ($timeout) => ({\n\trestrict: 'A',\n\tlink: (scope, elem, attrs) => {\n\t\tif (attrs.autofocus == 'true') {\n\t\t\t$timeout(() => { elem.focus(); });\n\t\t}\n    }\n})]);\n\napp.directive('typeEverywhere', ['$document', ($document) => ({\n\trequire: 'ngModel',\n\trestrict: 'A',\n\tscope: { ngModel: '=' },\n\tlink: (scope, elem, attrs) => {\n\t\t$document.bind('keypress', (e) => {\n\t\t\tlet keyCode\t= e.which || e.keyCode;\n\t\t\tlet tagName\t= angular.element($document[0].activeElement)[0].tagName;\n\n\t\t\tif (!_.includes([13], keyCode) && !_.includes(['INPUT', 'TEXTAREA'], tagName)) {\n\t\t\t\t// console.log('Got keypress:', String.fromCharCode(keyCode), keyCode);\n\t\t\t\t// if (_.isNil(scope.ngModel)) { scope.ngModel = ''; }\n\t\t\t\tscope.ngModel += String.fromCharCode(keyCode);\n\t\t\t\telem.focus();\n\t\t\t}\n\t\t});\n\t}\n})]);\n\napp.directive('openDropdown', ['$document', ($document) => ({\n\trestrict: 'A',\n\tscope: { openDropdown: '=' },\n\tlink: (scope, elem, attrs) => {\n\t\tscope.openDropdown\t= false;\n\n\t\tlet isCalender\t= _.includes(attrs.class, 'fa-calendar');\n\n\t\tlet childNode\t= [elem[0]];\n\t\tlet child\t\t= elem.children().length;\n\t\tlet current\t\t= elem.children();\n\t\twhile (child) {\n\t\t\tchildNode\t= _.concat(childNode, _.chain(current).pick(_.times(current.length)).values().value());\n\t\t\tcurrent\t\t= current.children();\n\t\t\tchild\t\t= current.length;\n\t\t}\n\t\tfunction theFunction(e) { scope.$apply(() => { scope.openDropdown = !scope.openDropdown; }); }\n\n\t\t// elem.bind('mouseover', theFunction);\n\t\telem.bind('click', theFunction);\n\n\t\t$document.bind('click', (e) => {\n\t\t\tif (_.includes(childNode, e.target)) return;\n\t\t\tif (isCalender && _.intersection([\n\t\t\t\t'date-between',\n\t\t\t\t'date-filter',\n\t\t\t\t'md-calendar-date',\n\t\t\t\t'md-datepicker-input-container',\n\t\t\t\t'md-calendar-date-selection-indicator',\n\t\t\t\t'md-datepicker-input',\n\t\t\t\t'md-datepicker-expand-triangle',\n\t\t\t\t'md-datepicker-triangle-button',\n\t\t\t\t'md-scroll-mask',\n\t\t\t\t'md-datepicker-calendar-pane'\n\t\t\t], angular.element(e.target).attr('class').split(' ')).length > 0) { return; }\n\n\t\t\tscope.$apply(() => { scope.openDropdown = false; });\n\t\t});\n\t}\n})]);\n\napp.directive('forceHeight', [() => ({\n\trestrict: 'A',\n\tlink: (scope, elem, attrs) => {\n\t\tlet widthTreshold = 800;\n\t\tlet params\t\t= attrs.forceHeight ? JSON.parse(attrs.forceHeight) : [];\n\t\tlet wantedRatio\t= ($(window).width() > widthTreshold ? params[0] : params[1]) || 1;\n\n\t\tscope.$watch(() => (elem.width()), (newVal, oldVal) => {\n\t\t\telem.css('height', (wantedRatio == 'full' ? ($(window).height() - 40) : (newVal * wantedRatio)) + 'px');\n\t\t});\n\n\t\telem.bind('resize', () => { scope.$apply(); });\n\t}\n})]);\n\napp.directive('setVillageWidth', [() => ({\n\trestrict: 'A',\n\tlink: (scope, elem, attrs) => {\n\t\tlet wantedRatio\t= attrs.setVillageWidth || 0;\n\n\t\tlet minWidth\t= 50; // in percent\n\t\tlet finalWidth\t= minWidth + (100 - minWidth) * (wantedRatio / scope.$parent.maxVillage);\n\n\t\telem.css('width', 'calc(' + (finalWidth) + '% - ' + (+_.replace(elem.css('padding'), 'px', '') * 2) + 'px)');\n\t}\n})]);\n"]}