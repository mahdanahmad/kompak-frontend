{"version":3,"sources":["../../js/directive.js"],"names":["app","directive","$timeout","restrict","link","scope","elem","attrs","autofocus","focus","$document","require","ngModel","bind","e","keyCode","which","tagName","angular","element","activeElement","_","includes","String","fromCharCode","openDropdown","childNode","child","children","length","current","concat","chain","pick","times","values","value","theFunction","$apply","target","wantedRatio","forceHeight","$watch","width","newVal","oldVal","css","setVillageWidth","minWidth","finalWidth","$parent","maxVillage","replace"],"mappings":"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","file":"directive.js","sourcesContent":["app.directive('autofocus', ['$timeout', ($timeout) => ({\n\trestrict: 'A',\n\tlink: (scope, elem, attrs) => {\n\t\tif (attrs.autofocus == 'true') {\n\t\t\t$timeout(() => { elem.focus(); });\n\t\t}\n    }\n})]);\n\napp.directive('typeEverywhere', ['$document', ($document) => ({\n\trequire: 'ngModel',\n\trestrict: 'A',\n\tscope: { ngModel: '=' },\n\tlink: (scope, elem, attrs) => {\n\t\t$document.bind('keypress', (e) => {\n\t\t\tlet keyCode\t= e.which || e.keyCode;\n\t\t\tlet tagName\t= angular.element($document[0].activeElement)[0].tagName;\n\n\t\t\tif (!_.includes([13], keyCode) && !_.includes(['INPUT', 'TEXTAREA'], tagName)) {\n\t\t\t\t// console.log('Got keypress:', String.fromCharCode(keyCode), keyCode);\n\t\t\t\t// if (_.isNil(scope.ngModel)) { scope.ngModel = ''; }\n\t\t\t\tscope.ngModel += String.fromCharCode(keyCode);\n\t\t\t\telem.focus();\n\t\t\t}\n\t\t});\n\t}\n})]);\n\napp.directive('openDropdown', ['$document', ($document) => ({\n\trestrict: 'A',\n\tscope: { openDropdown: '=' },\n\tlink: (scope, elem, attrs) => {\n\t\tscope.openDropdown\t= false;\n\n\t\tlet childNode\t= [elem[0]];\n\t\tlet child\t\t= elem.children().length;\n\t\tlet current\t\t= elem.children();\n\t\twhile (child) {\n\t\t\tchildNode\t= _.concat(childNode, _.chain(current).pick(_.times(current.length)).values().value());\n\t\t\tcurrent\t\t= current.children();\n\t\t\tchild\t\t= current.length;\n\t\t}\n\t\tfunction theFunction(e) { scope.$apply(() => { scope.openDropdown = !scope.openDropdown; }); }\n\n\t\t// elem.bind('mouseover', theFunction);\n\t\telem.bind('click', theFunction);\n\n\t\t$document.bind('click', (e) => {\n\t\t\tif (_.includes(childNode, e.target)) return;\n\t\t\tscope.$apply(() => { scope.openDropdown = false; });\n\t\t});\n\t}\n})]);\n\napp.directive('forceHeight', [() => ({\n\trestrict: 'A',\n\tlink: (scope, elem, attrs) => {\n\t\tlet wantedRatio\t= attrs.forceHeight || 1;\n\n\t\tscope.$watch(() => (elem.width()), (newVal, oldVal) => {\n\t\t\telem.css('height', (newVal * wantedRatio) + 'px');\n\t\t});\n\n\t\telem.bind('resize', () => { scope.$apply(); });\n\t}\n})]);\n\napp.directive('setVillageWidth', [() => ({\n\trestrict: 'A',\n\tlink: (scope, elem, attrs) => {\n\t\tlet wantedRatio\t= attrs.setVillageWidth || 0;\n\n\t\tlet minWidth\t= 50; // in percent\n\t\tlet finalWidth\t= minWidth + (100 - minWidth) * (wantedRatio / scope.$parent.maxVillage);\n\n\t\telem.css('width', 'calc(' + (finalWidth) + '% - ' + (+_.replace(elem.css('padding'), 'px', '') * 2) + 'px)');\n\t}\n})]);\n"]}