"use strict";var angular=angular,app=angular.module("app",["ui.router","ct.ui.router.extras.core","permission","permission.ui","LocalStorageModule","ngDialog","angular-loading-bar","ngAnimate","infinite-scroll","ngMaterial","wu.masonry","ngSanitize"]);app.config(["$stateProvider","$locationProvider","$urlRouterProvider","$httpProvider","$mdThemingProvider","localStorageServiceProvider","cfpLoadingBarProvider",function(a,b,c,d,e,f,g){c.otherwise(function(a){a.get("$state").go("dashboard")}),a.state("dashboard",{url:"",templateUrl:"views/dashboard/dashboard.html",controller:"DashboardController",abstract:!0}).state("dashboard.statistic",{url:"",templateUrl:"views/dashboard/statistic.html",controller:"StatisticController"}).state("dashboard.user",{url:"/user",templateUrl:"views/dashboard/user.html",controller:"UserController"}).state("dashboard.choices",{url:"/choices",templateUrl:"views/dashboard/choices/question.html",controller:"ChoicesController"}).state("dashboard.choicesAns",{url:"/choicesAns",templateUrl:"views/dashboard/choices/answer.html",controller:"ChoicesAnsController"}).state("dashboard.essay",{url:"/essay",templateUrl:"views/dashboard/essay/question.html",controller:"EssayController"}).state("dashboard.essayAns",{url:"/essayAns",templateUrl:"views/dashboard/essay/answer.html",controller:"EssayAnsController"}).state("dashboard.location",{url:"/location/:province/:regency/:district",templateUrl:"views/dashboard/location.html",controller:"LocationController",params:{province:{squash:!0,value:null},regency:{squash:!0,value:null},district:{squash:!0,value:null}}}).state("dashboard.misc",{url:"/misc",templateUrl:"views/dashboard/misc.html",controller:"MiscController"}),f.setPrefix("gapuradesa"),g.parentSelector="#loading-bar-container",e.disableTheming()}]),app.controller("MainController",["$scope","$rootScope","$location","localStorageService","fetcher",function(a,b,c,d,e){}]),app.run(["PermPermissionStore","localStorageService","$templateCache",function(a,b,c){}]),app.controller("CategoryController",["$scope","fetcher",function(a,b){}]),app.controller("ChoicesAnsController",["$scope","fetcher","$timeout","dialog","globalVar",function(a,b,c,d,e){var f=0;a.category={},a.data=[],a.pauseAjx=!1,a.doneAjx=!1,a.search="",a.nodata=null,a.loading=e.loading;var g=function(){return a.search&&a.search.length>=3?a.search:null};a.toDate=function(a){return moment(a).format("dddd, MMMM Do YYYY, h:mm a")},a.loadMoar=function(){a.pauseAjx=!0,f++;var c=_.omitBy({limit:15,offset:15*f,like:g(),category:a.category.id},_.isNil);b.getAllAnswer(c,function(b){"OK"==b.response&&200==b.status_code&&b.result?(b.result.length<15&&(a.doneAjx=!0),a.data=_.concat(a.data,b.result)):a.doneAjx=!0,a.pauseAjx=!1})};var h=void 0;a.$watch("search",function(b,d){_.isNil(b)||b===d?a.search="":(h&&c.cancel(h),h=c(function(){b.length>=3?i(b):""!=b||a.pauseAjx||i()},500))}),a.selectCate=function(b){a.category=b,i(g())},a.delete=function(a,c,e){e.stopPropagation(),d.confirm("Are you sure you wanna delete an answer by "+c+"?",function(c){c&&b.deleteAnswer(a,function(a){"OK"==a.response&&200==a.status_code&&i(g())})})};var i=function(c){a.pauseAjx=!0,a.nodata=null,f=0,b.getAllAnswer(_.omitBy({limit:15,like:c,offset:0,category:a.category.id},_.isNil),function(b){"OK"==b.response&&200==b.status_code&&(a.data=b.result,b.result?b.result.length<15?a.doneAjx=!0:a.doneAjx=!1:(a.nodata=e.nodata,a.doneAjx=!0),a.pauseAjx=!1)})};!function(){b.getAllCategory({},function(b){"OK"==b.response&&200==b.status_code&&(a.categories=_.chain(b.result).map(function(a){return{id:a.ID_category,name:a.category_name}}).concat([{id:null,name:"All"}]).sortBy(["name"]).value(),a.category=_.head(a.categories),i())})}()}]),app.controller("ChoicesController",["$scope","fetcher","$timeout","dialog","globalVar",function(a,b,c,d,e){var f=0;a.category={},a.data=[],a.pauseAjx=!1,a.doneAjx=!1,a.search="",a.nodata=null,a.loading=e.loading;var g=function(){return a.search&&a.search.length>=3?a.search:null};a.loadMoar=function(){a.pauseAjx=!0,f++;var c=_.omitBy({limit:10,offset:10*f,like:g(),category:a.category.id},_.isNil);b.getAllQuestion(c,function(b){"OK"==b.response&&200==b.status_code&&b.result?(b.result.length<10&&(a.doneAjx=!0),a.data=_.concat(a.data,b.result)):a.doneAjx=!0,a.pauseAjx=!1})};var h=void 0;a.$watch("search",function(b,d){_.isNil(b)||b===d?a.search="":(h&&c.cancel(h),h=c(function(){b.length>=3?i(b):""!=b||a.pauseAjx||i()},500))}),a.selectCate=function(b){a.category=b,i(g())},a.newQuestion=function(){d.choicesDialog({categories:a.categories},function(a){_.isObject(a)&&(a.question_enabled=a.question_enabled?"1":"0",b.postQuestion(_.mapValues(a,_.toString),function(a){"OK"==a.response&&200==a.status_code&&i(g())}))})},a.edit=function(c){async.waterfall([function(a){b.getQuestion(c,function(b){"OK"==b.response&&200==b.status_code?a(null,b.result):a(b.message)})},function(b,c){var e=_.clone(b);d.choicesDialog({data:b,categories:a.categories},function(a){_.isObject(a)&&!_.isEqual(e,a)?c(null,a):c(null)})}],function(a,c){a&&console.log(a),c&&(c.question_enabled=c.question_enabled?"1":"0",b.putQuestion(c.ID_question,_.chain(c).mapValues(_.toString).omit(["no_of_times_correctly_answered","no_of_times_incorrectly_answered","no_of_times_presented_as_challenge","no_of_times_response_1","no_of_times_response_2","no_of_times_response_3","no_of_times_response_4"]).value(),function(a){"OK"==a.response&&200==a.status_code&&i(g())}))})},a.changeEna=function(a,c){c.stopPropagation();var d=a.question_enabled?"0":"1";b.putQuestion(a.ID_question,{question_enabled:d},function(b){"OK"==b.response&&200==b.status_code&&(a.question_enabled=!a.question_enabled)})},a.delete=function(a,c,e){e.stopPropagation(),d.confirm('Are you sure you wanna delete question "'+c+'"?',function(c){c&&b.deleteQuestion(a,function(a){"OK"==a.response&&200==a.status_code&&i(g())})})};var i=function(c){a.pauseAjx=!0,a.nodata=null,f=0,b.getAllQuestion(_.omitBy({limit:10,like:c,offset:0,category:a.category.id},_.isNil),function(b){"OK"==b.response&&200==b.status_code&&(a.data=b.result,b.result?b.result.length<10?a.doneAjx=!0:a.doneAjx=!1:(a.nodata=e.nodata,a.doneAjx=!0),a.pauseAjx=!1)})};!function(){b.getAllCategory({},function(b){"OK"==b.response&&200==b.status_code&&(a.categories=_.chain(b.result).map(function(a){return{id:a.ID_category,name:a.category_name}}).concat([{id:null,name:"All"}]).sortBy(["name"]).value(),a.category=_.head(a.categories),i())})}()}]),app.controller("DashboardController",["$scope","$location","$document","$state","localStorageService","fetcher",function(a,b,c,d,e,f){a.menus=[{title:"Statistic",icon:"line-chart",state:"statistic"},{title:"User",icon:"user",state:"user"},{title:"Choices' Question",icon:"th-large",state:"choices"},{title:"Choices' Answer",icon:"square",state:"choicesAns"},{title:"Essay's Question",icon:"pencil-square-o",state:"essay"},{title:"Essay's Answer",icon:"file-text-o",state:"essayAns"},{title:"Location",icon:"map-o",state:"location"},{title:"Miscellaneous",icon:"cogs",state:"misc"}];var g=b.url().split("/")[1];a.active=g||_.chain(a.menus).head().get("state").value(),a.setActive=function(b){a.active=b,d.go("dashboard."+b)}}]),app.controller("EssayAnsController",["$scope","fetcher","$timeout","dialog","globalVar",function(a,b,c,d,e){var f=0;a.category={},a.data=[],a.pauseAjx=!1,a.doneAjx=!1,a.search="",a.nodata=null,a.loading=e.loading;var g=function(){return a.search&&a.search.length>=3?a.search:null};a.toDate=function(a){return moment(a).format("dddd, MMMM Do YYYY, h:mm a")},a.loadMoar=function(){a.pauseAjx=!0,f++;var c=_.omitBy({limit:15,offset:15*f,like:g(),category:a.category.id},_.isNil);b.getAllEssayAns(c,function(b){"OK"==b.response&&200==b.status_code&&b.result?(b.result.length<15&&(a.doneAjx=!0),a.data=_.concat(a.data,b.result)):a.doneAjx=!0,a.pauseAjx=!1})};var h=void 0;a.$watch("search",function(b,d){_.isNil(b)||b===d?a.search="":(h&&c.cancel(h),h=c(function(){b.length>=3?i(b):""!=b||a.pauseAjx||i()},500))}),a.selectCate=function(b){a.category=b,i(g())},a.delete=function(a,c,e){e.stopPropagation(),d.confirm("Are you sure you wanna delete an answer by "+c+"?",function(c){c&&b.deleteEssayAns(a,function(a){"OK"==a.response&&200==a.status_code&&i(g())})})};var i=function(c){a.pauseAjx=!0,a.nodata=null,f=0,b.getAllEssayAns(_.omitBy({limit:15,like:c,offset:0,category:a.category.id},_.isNil),function(b){"OK"==b.response&&200==b.status_code&&(a.data=b.result,b.result?b.result.length<15?a.doneAjx=!0:a.doneAjx=!1:(a.nodata=e.nodata,a.doneAjx=!0),a.pauseAjx=!1)})};!function(){b.getAllCategory({},function(b){"OK"==b.response&&200==b.status_code&&(a.categories=_.chain(b.result).map(function(a){return{id:a.ID_category,name:a.category_name}}).concat([{id:null,name:"All"}]).sortBy(["name"]).value(),a.category=_.head(a.categories),i())})}()}]),app.controller("EssayController",["$scope","fetcher","$timeout","dialog","globalVar",function(a,b,c,d,e){var f=0;a.category={},a.data=[],a.pauseAjx=!1,a.doneAjx=!1,a.search="",a.nodata=null,a.loading=e.loading;var g=function(){return a.search&&a.search.length>=3?a.search:null};a.loadMoar=function(){a.pauseAjx=!0,f++;var c=_.omitBy({limit:15,offset:15*f,like:g(),category:a.category.id},_.isNil);b.getAllEssay(c,function(b){"OK"==b.response&&200==b.status_code&&b.result?(b.result.length<15&&(a.doneAjx=!0),a.data=_.concat(a.data,b.result)):a.doneAjx=!0,a.pauseAjx=!1})};var h=void 0;a.$watch("search",function(b,d){_.isNil(b)||b===d?a.search="":(h&&c.cancel(h),h=c(function(){b.length>=3?i(b):""!=b||a.pauseAjx||i()},500))}),a.selectCate=function(b){a.category=b,i(g())},a.newQuestion=function(){d.essayDialog({categories:a.categories},function(a){_.isObject(a)&&b.postEssay(_.mapValues(a,_.toString),function(a){"OK"==a.response&&200==a.status_code&&i(g())})})},a.edit=function(c){async.waterfall([function(a){b.getEssay(c,function(b){"OK"==b.response&&200==b.status_code?a(null,b.result):a(b.message)})},function(b,c){var e=_.clone(b);d.essayDialog({data:b,categories:a.categories},function(a){_.isObject(a)&&!_.isEqual(e,a)?c(null,a):c(null)})}],function(a,c){a&&console.log(a),c&&b.putEssay(c.id,_.chain(c).mapValues(_.toString).omit([]).value(),function(a){"OK"==a.response&&200==a.status_code&&i(g())})})},a.delete=function(a,c,e){e.stopPropagation(),d.confirm('Are you sure you wanna delete question "'+c+'"?',function(c){c&&b.deleteEssay(a,function(a){"OK"==a.response&&200==a.status_code&&i(g())})})};var i=function(c){a.pauseAjx=!0,a.nodata=null,f=0,b.getAllEssay(_.omitBy({limit:15,like:c,offset:0,category:a.category.id},_.isNil),function(b){"OK"==b.response&&200==b.status_code&&(a.data=b.result,b.result?b.result.length<15?a.doneAjx=!0:a.doneAjx=!1:(a.nodata=e.nodata,a.doneAjx=!0),a.pauseAjx=!1)})};!function(){b.getAllCategory({},function(b){"OK"==b.response&&200==b.status_code&&(a.categories=_.chain(b.result).map(function(a){return{id:a.ID_category,name:a.category_name}}).concat([{id:null,name:"All"}]).sortBy(["name"]).value(),a.category=_.head(a.categories),i())})}()}]),app.controller("LocationController",["$scope","fetcher","$timeout","$state","$stateParams","dialog","globalVar",function(a,b,c,d,e,f,g){var h=0,i="",j="",k="";switch(!0){case!_.isNil(e.province)&&!_.isNil(e.regency)&&!_.isNil(e.district):i=e.province+"/"+e.regency+"/"+e.district+"/",a.state="village",j=e.district,k="district";break;case!_.isNil(e.province)&&!_.isNil(e.regency):i=e.province+"/"+e.regency+"/",a.state="district",j=e.regency,k="regency";break;case!_.isNil(e.province):i=e.province+"/",a.state="regency",j=e.province,k="province";break;default:a.state="province"}a.data=[],a.pauseAjx=!1,a.doneAjx=!1,a.search="",a.nodata=null,a.loading=g.loading,a.gotoLocation=function(b){var c={};c[a.state]=b,d.go("dashboard.location",_.assign({},_.omit(e,["#"]),c))},a.backLocation=function(){var a={};a[k]=null,d.go("dashboard.location",_.assign({},_.omit(e,["#"]),a))};var l=function(){return a.search&&a.search.length>=3?a.search:null},m=function(a){return _.chain(a).map(function(a){return _.chain(a).pickBy(function(a,b){return _.includes(["id"],b)||_.startsWith(b,"name")}).mapKeys(function(a,b){return"id"==b?"id":"name"}).value()}).value()};a.loadMoar=function(){a.pauseAjx=!0,h++;var c=_.omitBy({limit:20,offset:20*h,like:l()},_.isNil);b.getLocation(i,c,function(b){"OK"==b.response&&200==b.status_code&&b.result.data?(b.result.data.length<20&&(a.doneAjx=!0),a.data=_.concat(a.data,m(b.result.data))):a.doneAjx=!0,a.pauseAjx=!1})};var n=void 0;a.$watch("search",function(b,d){_.isNil(b)||b===d?a.search="":(n&&c.cancel(n),n=c(function(){b.length>=3?o(b):""!=b||a.pauseAjx||o()},500))}),a.newLocation=function(){f.locationDialog({state:a.state,isNew:!0,data:{id:j}},function(a){_.isObject(a)&&b.postLocation(i,_.mapValues(a,_.toString),function(a){"OK"==a.response&&200==a.status_code?o(l()):f.error(a.message)})})},a.edit=function(c,d){d.stopPropagation(),f.locationDialog({state:a.state,isNew:!1,data:_.clone(c)},function(a){_.isObject(a)&&b.putLocation(i+c.id,_.mapValues(a,_.toString),function(a){"OK"==a.response&&200==a.status_code?o(l()):f.error(a.message)})})},a.delete=function(a,c,d){d.stopPropagation(),f.confirm('Are you sure you wanna delete location "'+c+'"?',function(c){c&&b.deleteLocation(i+a,function(a){"OK"==a.response&&200==a.status_code?o(l()):f.error(a.message)})})};var o=function(c){a.pauseAjx=!0,a.nodata=null,h=0,b.getLocation(i,_.omitBy({limit:20,like:c,offset:0},_.isNil),function(b){"OK"==b.response&&200==b.status_code&&(a.title="province"==a.state?"<span>all</span> provinces":("regency"==a.state?"regencie":a.state)+"s <span>of "+b.result.name+"</span>",a.data=m(b.result.data),b.result.data?b.result.data.length<20?a.doneAjx=!0:a.doneAjx=!1:(a.nodata=g.nodata,a.doneAjx=!0),a.pauseAjx=!1)})};o()}]),app.controller("MiscController",["$scope","fetcher","$timeout","dialog","globalVar",function(a,b,c,d,e){a.setting={},a.categories={},a.badges={},a.institutions={},a.educations={},a.settingInputs=[{label:"version",model:"version",tag:"input",type:"text"},{label:"life",model:"life",tag:"input",type:"number"},{label:"number of top score list",model:"num_top_skor_list",tag:"input",type:"number"}],a.updateSetting=function(){b.putSetting(_.mapValues(a.setting,_.toString),function(a){"OK"==a.response&&200==a.status_code?d.notif(e.settingUpdated):d.error(e.globalError)})},a.new=function(a){var c=_.includes(["institution","education"],a)?"loneDialog":a+"Dialog";d[c](_.includes(["institution","education"],a)?{state:a}:{},function(c){_.isObject(c)&&(_.isNil(c.category_enabled)||(c.category_enabled=c.category_enabled?"1":"0"),_.isNil(c.name)||"institution"!=a||(c.name_institution=c.name),_.isNil(c.name)||"education"!=a||(c.education=c.name),b["post"+_.upperFirst(a)](_.mapValues(c,_.toString),function(b){"OK"==b.response&&200==b.status_code&&f[a]()}))})},a.edit=function(a,c){var e=_.includes(["institution","education"],c)?"loneDialog":c+"Dialog",g=null,h=null;switch(c){case"category":g=a.ID_category,h=_.clone(a);break;case"badge":g=a.ID_Badge,h=_.clone(a);break;default:g=a.id,h={data:_.chain(a).clone().mapKeys(function(a,b){return _.includes(["name_institution","education"],b)?"name":b}).value(),state:c}}d[e](h,function(a){_.isObject(a)&&(_.isNil(a.category_enabled)||(a.category_enabled=a.category_enabled?"1":"0"),_.isNil(a.name)||"institution"!=c||(a.name_institution=a.name),_.isNil(a.name)||"education"!=c||(a.education=a.name),b["put"+_.upperFirst(c)](g,_.mapValues(a,_.toString),function(a){"OK"==a.response&&200==a.status_code?f[c]():d.error(a.message)}))})},a.delete=function(a,c,e,g){g.stopPropagation(),d.confirm("Are you sure you wanna delete "+e+' "'+c+'"?',function(c){c&&b["delete"+_.upperFirst(e)](a,function(a){"OK"==a.response&&200==a.status_code?f[e]():d.error(a.message)})})},a.changeEna=function(a,c){c.stopPropagation();var d=a.category_enabled?"0":"1";b.putCategory(a.ID_category,{category_enabled:d},function(b){"OK"==b.response&&200==b.status_code&&(a.category_enabled=!a.category_enabled)})};var f={setting:function(){b.getSetting(function(b){"OK"==b.response&&200==b.status_code&&(a.setting=b.result)})},category:function(){b.getAllCategory({},function(b){"OK"==b.response&&200==b.status_code&&(a.categories=b.result)})},badge:function(){b.getAllBadge({},function(b){"OK"==b.response&&200==b.status_code&&(a.badges=b.result)})},institution:function(){b.getAllInstitution({},function(b){"OK"==b.response&&200==b.status_code&&(a.institutions=b.result)})},education:function(){b.getAllEducation({},function(b){"OK"==b.response&&200==b.status_code&&(a.educations=b.result)})}};!function(){f.setting(),f.category(),f.badge(),f.institution(),f.education()}()}]),app.controller("StatisticController",["$scope","fetcher",function(a,b){}]),app.controller("UserController",["$scope","fetcher","$timeout","dialog","globalVar",function(a,b,c,d,e){var f=0;a.search="",a.nodata=null,a.loading=e.loading,a.data=[],a.pauseAjx=!1,a.doneAjx=!1,a.loadMoar=function(){a.pauseAjx=!0,f++;var c=_.omitBy({limit:10,offset:10*f,like:a.search&&a.search.length>=3?a.search:null,orderby:a.orderby.value+" "+a.orderby.order},_.isNil);b.getAllUser(c,function(b){"OK"==b.response&&200==b.status_code&&b.result?(b.result.length<10&&(a.doneAjx=!0),a.data=_.concat(a.data,b.result)):a.doneAjx=!0,a.pauseAjx=!1})};var g=void 0;a.$watch("search",function(b,d){_.isNil(b)||b===d?a.search="":(g&&c.cancel(g),g=c(function(){b.length>=3?h(b):""!=b||a.pauseAjx||h()},500))}),a.orderOptions=[{title:"name",value:"usr_display_name",order:"ASC"},{title:"designation",value:"usr_designation",order:"ASC"},{title:"village",value:"usr_village",order:"ASC"},{title:"age",value:"usr_years",order:"ASC"},{title:"score",value:"usr_score",order:"ASC"},{title:"contribution",value:"usr_contribution",order:"ASC"}],a.orderby=_.head(a.orderOptions),a.selectSort=function(b){a.orderby.title==b.title?b.order="ASC"==b.order?"DESC":"ASC":b.order="ASC",a.orderby=b,h(a.search&&a.search.length>=3?a.search:null)},a.newUser=function(){d.userDialog({},function(c){_.isObject(c)&&b.postUser(_.mapValues(c,_.toString),function(b){"OK"==b.response&&200==b.status_code&&h(a.search&&a.search.length>=3?a.search:null)})})},a.editUser=function(c){async.waterfall([function(a){b.getUser(c,function(b){"OK"==b.response&&200==b.status_code?a(null,b.result):a(b.message)})},function(a,b){var c=_.clone(a);d.userDialog(a,function(a){_.isObject(a)&&!_.isEqual(c,a)?b(null,a):b(null)})}],function(c,d){c&&console.log(c),d&&b.putUser(d.ID,_.chain(d).mapValues(_.toString).omit(["last_logged_in","usr_score"]).value(),function(b){"OK"==b.response&&200==b.status_code&&h(a.search&&a.search.length>=3?a.search:null)})})},a.emailTo=function(a,b,c){c.stopPropagation()},a.delete=function(c,e,f){f.stopPropagation(),d.confirm("Are you sure you wanna delete "+e+"'s account?",function(d){d&&b.deleteUser(c,function(b){"OK"==b.response&&200==b.status_code&&h(a.search&&a.search.length>=3?a.search:null)})})};var h=function(c){a.pauseAjx=!0,a.nodata=null,f=0,b.getAllUser(_.omitBy({limit:10,like:c,offset:0,orderby:a.orderby.value+" "+a.orderby.order},_.isNil),function(b){"OK"==b.response&&200==b.status_code&&(a.data=b.result,b.result?b.result.length<10?a.doneAjx=!0:a.doneAjx=!1:(a.nodata=e.nodata,a.doneAjx=!0),a.pauseAjx=!1)})};h()}]),app.controller("ModalBadgeController",["$scope",function(a){a.data=a.ngDialogData.content||{},a.inputs=[{label:"name",model:"badge_name",tag:"input",type:"text",required:!0},{label:"text",model:"badge_text",tag:"input",type:"text",required:!0},{label:"score minimum",model:"score_min",tag:"input",type:"number",required:!0},{label:"score maximum",model:"score_max",tag:"input",type:"number",required:!0}]}]),app.controller("ModalCategoryController",["$scope",function(a){a.data=a.ngDialogData.content||{},a.inputs=[{label:"name",model:"category_name",tag:"input",type:"text",required:!0},{label:"description",model:"category_description",tag:"textarea"},{label:"enable category",model:"category_enabled",tag:"checkbox"}]}]),app.controller("ModalChoicesController",["$scope",function(a){a.data=a.ngDialogData.content.data||{},a.inputs=[{label:"question",model:"question_text",tag:"textarea",required:!0},{label:"answer 1",model:"response_1",tag:"textarea",required:!0},{label:"answer 2",model:"response_2",tag:"textarea",required:!0},{label:"answer 3",model:"response_3",tag:"textarea",required:!0},{label:"answer 4",model:"response_4",tag:"textarea",required:!0},{label:"correct answer",model:"correct_response",tag:"select",value:_.chain(4).times(function(a){return a+1}).map(function(a){return{id:a,name:a}}).value(),required:!0},{label:"category",model:"question_category",tag:"select",value:_.omitBy(a.ngDialogData.content.categories,function(a){return _.isNil(a.id)}),required:!0},{label:"point value",model:"bonus_value",tag:"input",type:"number"},{label:"time to answer (minutes)",model:"time_to_answer",tag:"input",type:"number"},{label:"enable question",model:"question_enabled",tag:"checkbox"}]}]),app.controller("ModalEssayController",["$scope",function(a){a.data=a.ngDialogData.content.data||{},a.inputs=[{label:"essay question",model:"question",tag:"textarea",required:!0},{label:"category",model:"ID_category",tag:"select",value:_.omitBy(a.ngDialogData.content.categories,function(a){return _.isNil(a.id)}),required:!0}]}]),app.controller("ModalLocationController",["$scope",function(a){a.data=a.ngDialogData.content.data||{},a.inputs=[{label:"id",model:"id",tag:"input",required:!0},{label:"name",model:"name",tag:"input",required:!0}]}]),app.controller("ModalLoneController",["$scope",function(a){a.data=a.ngDialogData.content.data||{},a.inputs=[{label:"name",model:"name",tag:"input",type:"text",required:!0}]}]),app.controller("ModalUserController",["$scope","fetcher",function(a,b){a.data=a.ngDialogData.content||{},a.autoData={province:[],regency:[],district:[],village:[]},a.autoSearch={province:"",regency:"",district:"",village:""},a.autoModel={province:null,regency:null,district:null,village:null};var c=function(a){return _.chain(a).map(function(a){return _.chain(a).pickBy(function(a,b){return _.includes(["id","education"],b)||_.startsWith(b,"name")}).mapKeys(function(a,b){return"id"==b?"id":"name"}).value()}).value()},d=function(b,c,d){var e=_.find(b,["id",c]);a.autoData[d]=e,a.autoSearch[d]=e.name},e=function(a){return function(b){return _.includes(angular.lowercase(b.name),angular.lowercase(a))}};a.querySearch=function(b){return a.autoSearch[b]?a.autoData[b].filter(e(a.autoSearch[b])):a.autoData[b]},a.isDisAuto=function(b){switch(b){case"regency":return _.isEmpty(a.data.usr_province);case"district":return _.isEmpty(a.data.usr_province)||_.isEmpty(a.data.usr_regency);case"village":return _.isEmpty(a.data.usr_province)||_.isEmpty(a.data.usr_regency)||_.isEmpty(a.data.usr_district);default:return!1}},a.autoChanged=function(d,e,f){if(d){var g="",h=["province","regency","district","village"],i=_.indexOf(h,e)+1;switch(a.data[f]=d,e){case"province":g=d;break;case"regency":g=a.data.usr_province+"/"+d;break;case"district":g=a.data.usr_province+"/"+a.data.usr_regency+"/"+d;break;default:return}_.chain(h).drop(i).forEach(function(b){a.autoModel[b]=null,a.autoSearch[b]="",a.data["usr_"+b]=null}).value(),b.getLocation(g,{},function(b){"OK"==b.response&&200==b.status_code&&(a.autoData[h[i]]=c(b.result))})}};!function(){async.parallel({instits:function(a){b.getAllInstitution({},function(b){"OK"==b.response&&200==b.status_code?a(null,c(b.result)):a(b.message)})},educats:function(a){b.getAllEducation({},function(b){"OK"==b.response&&200==b.status_code?a(null,c(b.result)):a(b.message)})},province:function(e){b.getLocation("",{},function(b){if("OK"==b.response&&200==b.status_code){var f=c(b.result);a.data.usr_province&&d(f,a.data.usr_province,"province"),e(null,f)}else e(b.message)})},regency:function(e){a.data.ID&&a.data.usr_province?b.getLocation(a.data.usr_province,{},function(b){if("OK"==b.response&&200==b.status_code){var f=c(b.result);a.data.usr_regency&&d(f,a.data.usr_regency,"regency"),e(null,f)}else e(b.message)}):e(null,[])},district:function(e){a.data.ID&&a.data.usr_province&&a.data.usr_regency?b.getLocation(a.data.usr_province+"/"+a.data.usr_regency,{},function(b){if("OK"==b.response&&200==b.status_code){var f=c(b.result);a.data.usr_district&&d(f,a.data.usr_district,"district"),e(null,f)}else e(b.message)}):e(null,[])},village:function(e){a.data.ID&&a.data.usr_province&&a.data.usr_regency&&a.data.usr_district?b.getLocation(a.data.usr_province+"/"+a.data.usr_regency+"/"+a.data.usr_district,{},function(b){if("OK"==b.response&&200==b.status_code){var f=c(b.result);a.data.usr_village&&d(f,a.data.usr_village,"village"),e(null,f)}else e(b.message)}):e(null,[])}},function(b,c){b&&console.log(b),a.autoData.province=c.province,a.autoData.regency=c.regency,a.autoData.district=c.district,a.autoData.village=c.village,a.inputs=[{label:"name",model:"usr_display_name",tag:"input",type:"text",required:!0},{label:"email",model:"usr_email",tag:"input",type:"email",required:!0},{label:"password",model:"usr_password",tag:"input",type:"password",required:!0},{label:"year of born",model:"usr_year_born",tag:"input",type:"number"},{label:"designation",model:"usr_designation",tag:"input",type:"text"},{label:"gender",model:"usr_gender",tag:"radio",value:[{label:"male",value:"m"},{label:"female",value:"f"}]},{label:"institution",model:"usr_institution",tag:"select",value:c.instits},{label:"education",model:"usr_education",tag:"select",value:c.educats},{label:"province",model:"usr_province",tag:"autocomplete",value:"province"},{label:"regency",model:"usr_regency",tag:"autocomplete",value:"regency"},{label:"district",model:"usr_district",tag:"autocomplete",value:"district"},{label:"village",model:"usr_village",tag:"autocomplete",value:"village"}]})}()}]),app.directive("autofocus",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){"true"==d.autofocus&&a(function(){c.focus()})}}}]),app.directive("typeEverywhere",["$document",function(a){return{require:"ngModel",restrict:"A",scope:{ngModel:"="},link:function(b,c,d){a.bind("keypress",function(d){var e=d.which||d.keyCode,f=angular.element(a[0].activeElement)[0].tagName;_.includes([13],e)||_.includes(["INPUT","TEXTAREA"],f)||(b.ngModel+=String.fromCharCode(e),c.focus())})}}}]),app.directive("openDropdown",["$document",function(a){return{restrict:"A",scope:{openDropdown:"="},link:function(b,c,d){function e(a){b.$apply(function(){b.openDropdown=!b.openDropdown})}b.openDropdown=!1;for(var f=[c[0]],g=c.children().length,h=c.children();g;)f=_.concat(f,_.chain(h).pick(_.times(h.length)).values().value()),h=h.children(),g=h.length;c.bind("click",e),a.bind("click",function(a){_.includes(f,a.target)||b.$apply(function(){b.openDropdown=!1})})}}}]),app.factory("fetcher",["$http","$httpParamSerializer","$window","$location",function(a,b,c,d){var e="http://localhost:3010/",f={headers:{"Content-Type":"application/json; charset=utf-8"}};return{getAllUser:function(c,d){a.get(e+"user?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getUser:function(b,c){a.get(e+"user/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postUser:function(b,c){a.post(e+"user",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putUser:function(b,c,d){a.put(e+"user/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteUser:function(b,c){a.delete(e+"user/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllQuestion:function(c,d){a.get(e+"question?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getQuestion:function(b,c){a.get(e+"question/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postQuestion:function(b,c){a.post(e+"question",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putQuestion:function(b,c,d){a.put(e+"question/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteQuestion:function(b,c){a.delete(e+"question/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllAnswer:function(c,d){a.get(e+"answer?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getAnswer:function(b,c){a.get(e+"answer/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postAnswer:function(b,c){a.post(e+"answer",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putAnswer:function(b,c,d){a.put(e+"answer/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteAnswer:function(b,c){a.delete(e+"answer/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllEssay:function(c,d){a.get(e+"essay?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getEssay:function(b,c){a.get(e+"essay/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postEssay:function(b,c){a.post(e+"essay",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putEssay:function(b,c,d){a.put(e+"essay/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteEssay:function(b,c){a.delete(e+"essay/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllEssayAns:function(c,d){a.get(e+"essayanswer?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getEssayAns:function(b,c){a.get(e+"essayanswer/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postEssayAns:function(b,c){a.post(e+"essayanswer",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putEssayAns:function(b,c,d){a.put(e+"essayanswer/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteEssayAns:function(b,c){a.delete(e+"essayanswer/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllEducation:function(c,d){a.get(e+"education?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getEducation:function(b,c){a.get(e+"education/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postEducation:function(b,c){a.post(e+"education",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putEducation:function(b,c,d){a.put(e+"education/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteEducation:function(b,c){a.delete(e+"education/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllInstitution:function(c,d){a.get(e+"institution?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getInstitution:function(b,c){a.get(e+"institution/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postInstitution:function(b,c){a.post(e+"institution",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putInstitution:function(b,c,d){a.put(e+"institution/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteInstitution:function(b,c){a.delete(e+"institution/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getLocation:function(c,d,g){a.get(e+"location/"+c+"?"+b(d),f).then(function(a){g(a.data)},function(a){g(a.data)})},postLocation:function(b,c,d){a.post(e+"location/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},putLocation:function(b,c,d){a.put(e+"location/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteLocation:function(b,c){a.delete(e+"location/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllCategory:function(c,d){a.get(e+"category?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getCategory:function(b,c){a.get(e+"category/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postCategory:function(b,c){a.post(e+"category",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putCategory:function(b,c,d){a.put(e+"category/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteCategory:function(b,c){a.delete(e+"category/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getSetting:function(b){a.get(e+"setting",f).then(function(a){b(a.data)},function(a){b(a.data)})},putSetting:function(b,c){a.put(e+"setting",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},getAllBadge:function(c,d){a.get(e+"badge?"+b(c),f).then(function(a){d(a.data)},function(a){d(a.data)})},getBadge:function(b,c){
a.get(e+"badge/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})},postBadge:function(b,c){a.post(e+"badge",b,f).then(function(a){c(a.data)},function(a){c(a.data)})},putBadge:function(b,c,d){a.put(e+"badge/"+b,c,f).then(function(a){d(a.data)},function(a){d(a.data)})},deleteBadge:function(b,c){a.delete(e+"badge/"+b,f).then(function(a){c(a.data)},function(a){c(a.data)})}}}]),app.factory("dialog",["ngDialog",function(a){var b=function(b,c,d,e,f,g){return a.open({template:"views/dialogs/"+c+".html",className:"ngdialog-theme-default"+(g?" "+g:""),data:{content:b},width:e||450,showClose:f||!1,controller:d})};return{userDialog:function(a,c){b(a,"user","ModalUserController",1e3).closePromise.then(function(a){c(a.value)})},choicesDialog:function(a,c){b(a,"choices","ModalChoicesController",1e3).closePromise.then(function(a){c(a.value)})},essayDialog:function(a,c){b(a,"essay","ModalEssayController",1e3).closePromise.then(function(a){c(a.value)})},locationDialog:function(a,c){b(a,"location","ModalLocationController",600).closePromise.then(function(a){c(a.value)})},categoryDialog:function(a,c){b(a,"category","ModalCategoryController",600).closePromise.then(function(a){c(a.value)})},badgeDialog:function(a,c){b(a,"badge","ModalBadgeController",750).closePromise.then(function(a){c(a.value)})},loneDialog:function(a,c){b(a,"lone","ModalLoneController",600).closePromise.then(function(a){c(a.value)})},confirm:function(a,c){b(a,"confirm",["$scope",function(a){}]).closePromise.then(function(a){c("yes"==a.value)})},notif:function(a){b(a,"notif",["$scope",function(a){}])},error:function(a){b(a,"error",["$scope",function(a){}])}}}]),app.factory("globalVar",[function(){return{nodata:"no data available at this point.",loading:"loading data",globalError:"something something happened. please smell your coffee while we fixing this.",settingUpdated:"setting successfully updated."}}]);
//# sourceMappingURL=main.min.js.map